<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Allow pinning of website on windows -->
    <meta name="application-name" content="Erlang.org">
    <meta name="msapplication-tooltip" content="The official home of the Erlang Programming Language">
    <meta name="msapplication-starturl" content="/erlang-org/" >

    <!-- Make the site look nicer on facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Erlang.org">
    <meta property="og:title" content="Welcome to Erlang.org">
    <meta property="og:description" content="The official home of the Erlang Programming Language">
    <meta property="og:image" content="https://erlang.github.io/erlang-org/assets/img/erlang-228x200.png">
    <meta property="og:image:secure_url" content="https://erlang.github.io/erlang-org/assets/img/erlang-228x200.png">
    <meta property="og:url" content="https://erlang.github.io/erlang-org/">

    <!-- Twitter metadata -->
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Index" />
    <meta name="twitter:site" content="@erlang_org" />

    <!-- Rich data for google search -->
    <script type="application/ld+json">
{"@type":"WebSite","url":"https://erlang.org/","headline":"OTP 23 Highlights - Erlang/OTP","name":"Erlang.org","sameAs":["https://twitter.com/erlang_org","https://github.com/erlang/otp"],"@context":"https://schema.org"}</script>

    <title>OTP 23 Highlights - Erlang/OTP</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- tells iOS browsers to not show telephone numbers as links -->
    <meta name="format-detection" content="telephone=no">

    <meta name="application-name" content="Erlang.org">
    <meta name="description" content="The official home of the Erlang Programming Language">
    <meta name="keywords" content="Erlang programming language functional parallel distributed documentation download community">
    <!-- https://www.rssboard.org/rss-autodiscovery -->
    <link rel="alternate" type="application/atom+xml" title="News Atom Feed" href="https://erlang.github.io/erlang-org/news.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Atom Feed" href="https://erlang.github.io/erlang-org/blog.xml" />
    
    <link rel="stylesheet" href="/erlang-org/assets/css/main.css">
</head>

<body>
    <header class="navbar navbar-expand-lg navbar-light bg-body">
        <nav class="container">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/erlang-org/"><img
                    src="/erlang-org/assets/img/erlang.png" class="img-fluid" width="60" alt="Erlang.org main page"/></a>
            <div class="collapse navbar-collapse fw-bold" id="navbarSupportedContent">
                <ul class="navbar-nav text-uppercase me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/downloads">Download</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/docs">Documentation</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/community">Community</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/blog">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/eep">EEP</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/about">About</a></li>
                </ul>
                <form class="d-flex" role="search" method="post" action="https://duckduckgo.com/?kg=p"
                    onsubmit="document.getElementById('searchq').value = document.getElementById('searchfield').value + ' site:erlang.org'; return true;">
                    <input type="hidden" id="searchq" name="q" class="hidden" />
                    <input class="form-control me-2" id="searchfield" type="search" placeholder="Search erlang.org"
                        aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
            </div>
        </nav>
    </header>
    <div class="container border-top pt-4">
    <div class="row-lg">
        <div class="col-lg-8 offset-lg-2">
            <article class="card mb-4">
    <div class="card-header">
        <h3><a href="/erlang-org/blog/OTP-23-Highlights/">OTP 23 Highlights</a></h3>
        <div class="date">May 13, 2020
             · by Kenneth Lundin
        </div>
    </div>

    <div class="card-body">
        
        
        
        <p>OTP 23 has just been released (May 13:th 2020).
It has been a long process with three release
candidates in February, March and April before the final release.
We are very thankful for the feedback we have got regarding the release candidates,
which has revealed some bugs and flaws that our internal testing did not find.</p>

<p>This blog post will describe some highlights of what is new in OTP 23.</p>

<p>You can download the readme describing the changes here:
<a href="http://erlang.org/download/otp_src_23.0.readme">OTP 23 Readme</a>.
Or, as always, look at the release notes of the application you are interested in.
For instance here: <a href="http://erlang.org/doc/apps/erts/notes.html">OTP 23 Erts Release Notes</a>.</p>
      <h1 id="language">
        
        
          Language <a href="#language">#</a>
        
        
      </h1>
    

<p>In OTP 23 we have added some new features to the language and compiler, one has been in the backlog since the bit syntax was introduced and the other is a suggestion from the community.</p>
      <h2 id="matching-syntax-improvements">
        
        
          Matching syntax improvements​ <a href="#matching-syntax-improvements">#</a>
        
        
      </h2>
    
      <h3 id="binary-matching">
        
        
          Binary matching <a href="#binary-matching">#</a>
        
        
      </h3>
    
<p>In binary matching, the size of the segment to be matched is now allowed to be a guard expression. In the example below the variable <code class="language-plaintext highlighter-rouge">Size</code> is bound to the first 8 bits and then it is used in an expression <code class="language-plaintext highlighter-rouge">(Size-1)*8</code> for the size of the following binary.</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">example1</span><span class="p">(</span><span class="o">&lt;&lt;</span><span class="nv">Size</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="nv">Payload</span><span class="p">:((</span><span class="nv">Size</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="n">binary</span><span class="p">,</span><span class="nv">Rest</span><span class="o">/</span><span class="n">binary</span><span class="o">&gt;&gt;</span><span class="p">)</span> <span class="o">-&gt;</span><span class="err">​</span>
    <span class="p">{</span><span class="nv">Payload</span><span class="p">,</span><span class="nv">Rest</span><span class="p">}.</span>
</code></pre></div></div>
      <h3 id="matching-on-maps">
        
        
          Matching on maps <a href="#matching-on-maps">#</a>
        
        
      </h3>
    
<p>In the current map matching syntax, the key in a map pattern must be a single value or a literal. This leads to unnatural code if the keys in a map are complex terms.​</p>

<p>With OTP 23 the keys in map matching can be guard expressions as you see in new_example2.​</p>

<p>The only limitation is that all variables used in a key expression must be previously bound.</p>

<p>Previously you had to do like this:</p>

<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">example2</span><span class="p">(</span><span class="nv">M</span><span class="p">,</span> <span class="nv">X</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">Key</span> <span class="o">=</span> <span class="p">{</span><span class="n">tag</span><span class="p">,</span><span class="nv">X</span><span class="p">},</span>
    <span class="err">#</span><span class="p">{</span><span class="nv">Key</span> <span class="p">:</span><span class="o">=</span> <span class="nv">Value</span><span class="p">}</span> <span class="o">=</span> <span class="nv">M</span><span class="p">,</span>
    <span class="nv">Value</span><span class="p">.</span>
</code></pre></div></div>
<p>And now you can do like this:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">new_example2</span><span class="p">(</span><span class="nv">M</span><span class="p">,</span> <span class="nv">X</span><span class="p">)</span> <span class="o">-&gt;</span><span class="err">​</span>
    <span class="err">#</span><span class="p">{</span> <span class="p">{</span><span class="n">tag</span><span class="p">,</span><span class="nv">X</span><span class="p">}</span> <span class="p">:</span><span class="o">=</span> <span class="nv">Value</span><span class="p">}</span> <span class="o">=</span> <span class="nv">M</span><span class="p">,</span><span class="err">​</span>
    <span class="nv">Value</span><span class="p">.</span><span class="err">​</span>
</code></pre></div></div>

<p>Below there is an illegal example showing that it is still not supported to use an unbound variable as part of the expression for the key-pattern. In this case Key is not bound and the requirement is that all variables used in a key expression must be previously bound.</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">illegal_example</span><span class="p">(</span><span class="nv">Key</span><span class="p">,</span> <span class="err">#</span><span class="p">{</span><span class="nv">Key</span> <span class="p">:</span><span class="o">=</span> <span class="nv">Value</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="nv">Value</span><span class="p">.</span>
</code></pre></div></div>
      <h2 id="numeric-literals-with-underscore">
        
        
          Numeric literals with underscore <a href="#numeric-literals-with-underscore">#</a>
        
        
      </h2>
    
<p>It is now allowed to write numeric literals with underscore between the digits for the purpose of readability. But the placement of the underscores is not totally free there are some rules. See example of allowed use below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>305441741123_456
1_2_3_4_5
123_456.789_123
1.0e1_23
16#DEAD_BEEF
2#1100_1010_0011
</code></pre></div></div>
<p>And in the following example we have some examples of disallowed placement of the underscore:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>_123  % variable name
123_
123__456  % only single ‘_’
123_.456
123._456
16#_1234
16#1234_
</code></pre></div></div>
      <h1 id="distributed-spawn-and-the-new-erpc-module">
        
        
          Distributed spawn and the new <code class="language-plaintext highlighter-rouge">erpc</code> module <a href="#distributed-spawn-and-the-new-erpc-module">#</a>
        
        
      </h1>
    
      <h2 id="improved-spawn">
        
        
          Improved spawn <a href="#improved-spawn">#</a>
        
        
      </h2>
    

<p>The spawn operation is improved regarding scalability and performance for the distributed case. That is when spawning a process on another node.</p>

<p>New features are also added, such as a distributed <code class="language-plaintext highlighter-rouge">spawn_monitor()</code> BIF. This function creates a new process and sets up a monitor atomically.</p>

<p>The <code class="language-plaintext highlighter-rouge">spawn_opt()</code> BIF will also support the monitor option for setting up a monitor atomically while creating a process on another node.</p>

<p>We have also added new <a href="http://erlang.org/doc/man/erlang.html#spawn_request-1"><code class="language-plaintext highlighter-rouge">spawn_request()</code></a> BIFs for asynchronous spawning of processes.
<code class="language-plaintext highlighter-rouge">spawn_request()</code> supports all options that <code class="language-plaintext highlighter-rouge">spawn_opt()</code> already supports.</p>

<p>The spawn improvements described above can also be used to optimize and improve many of the functions in the <code class="language-plaintext highlighter-rouge">rpc</code> module but since the new functions will not be 100% compatible we decided to introduce a new module named <code class="language-plaintext highlighter-rouge">erpc</code> and will keep the old <code class="language-plaintext highlighter-rouge">rpc</code> module as well.</p>

<p>The <code class="language-plaintext highlighter-rouge">erpc</code> module implements an enhanced subset of the operations provided by the <code class="language-plaintext highlighter-rouge">rpc</code> module.</p>

<p>Enhanced in the sense that it makes it possible to distinguish between returned value, raised exceptions, and other errors.​</p>

<p><code class="language-plaintext highlighter-rouge">erpc</code> also has better performance and scalability than the original <code class="language-plaintext highlighter-rouge">rpc</code> implementation. This by utilizing the newly introduced <code class="language-plaintext highlighter-rouge">spawn_request()</code> BIF.</p>

<p>The <code class="language-plaintext highlighter-rouge">rpc</code>module now share the same implementation as <code class="language-plaintext highlighter-rouge">erpc</code> and by that users of <code class="language-plaintext highlighter-rouge">rpc</code> will automatically benefit from the performance and scalability improvements made in <code class="language-plaintext highlighter-rouge">erpc</code>.</p>

<p>The pictures below illustrate the old and the new implementation of rpc:call() and shows why the new one is more efficient and scalable.</p>

<p>“old” rpc:call implementation:
<img class="img-fluid"src="../images/rpc1.png" alt="old rpc illustration" /></p>

<p>new rcp:call implementation with support in the distribution protocol (spawn request)
<img class="img-fluid"src="../images/rpc2.png" alt="new rpc illustration" /></p>

<p>As you can see in the “old” implementation above the <code class="language-plaintext highlighter-rouge">rpc:call</code> relies on the <code class="language-plaintext highlighter-rouge">rex</code> process on the receiving node to spawn a temporary process to execute the called function. This will make <code class="language-plaintext highlighter-rouge">rex</code> to a bottleneck if there are many simultaneous <code class="language-plaintext highlighter-rouge">rpc:calls</code> towards the node.</p>

<p>The new solution does not use <code class="language-plaintext highlighter-rouge">rex</code> at all and let the spawned process decode the arguments of the call thus avoiding some unnecessary copying of data that occurs in the “old” implementation.</p>
      <h1 id="gen_tcp-and-the-new-socket-module">
        
        
          gen_tcp and the new socket module <a href="#gen_tcp-and-the-new-socket-module">#</a>
        
        
      </h1>
    

<p>In OTP 22 we introduced the new experimental <a href="http://erlang.org/doc/man/socket.html">socket</a> API.
The idea behind this API is to have a stable intermediary API that can be used
to create features that are not part of the higher-level <code class="language-plaintext highlighter-rouge">gen_*</code> APIs.</p>

<p>We have now come one step further in our plan to replace the inet driver by making it possible to use the <code class="language-plaintext highlighter-rouge">gen_tcp</code> API with <code class="language-plaintext highlighter-rouge">socket</code> as an optional back-end.</p>

<p>To make it easy to test with existing code using <code class="language-plaintext highlighter-rouge">gen_tcp</code> a new option <code class="language-plaintext highlighter-rouge">{inet_backend, socket | inet}</code> can be used to select the <code class="language-plaintext highlighter-rouge">socket</code> implementation instead of the default <code class="language-plaintext highlighter-rouge">inet</code> implementation. This option must be put first in the option list to the functions: <code class="language-plaintext highlighter-rouge">gen_tcp:listen</code>, <code class="language-plaintext highlighter-rouge">gen_tcp:connect</code> and <code class="language-plaintext highlighter-rouge">gen_tcp:fdopen</code>, which are all functions that create a socket. For example like this:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="n">ok</span><span class="p">,</span><span class="nv">Socket</span><span class="p">}</span> <span class="o">=</span> <span class="nn">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p">(</span><span class="nv">Addr</span><span class="p">,</span><span class="nv">Port</span><span class="p">,[{</span><span class="n">inet_backend</span><span class="p">,</span><span class="n">socket</span><span class="p">}|</span><span class="nv">OtherOpts</span><span class="p">])</span>
</code></pre></div></div>
<p>The returned <code class="language-plaintext highlighter-rouge">Socket</code> is a <code class="language-plaintext highlighter-rouge">'$inet'</code> tagged 3-tuple instead of a port, so all other API functions will use the right implementation for the socket.</p>

<p>A more general override is to use the Kernel configuration variable <code class="language-plaintext highlighter-rouge">inet_backend</code> and set it to <code class="language-plaintext highlighter-rouge">socket</code> or <code class="language-plaintext highlighter-rouge">inet</code>.  For example on the <code class="language-plaintext highlighter-rouge">erl</code> command-line as</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>erl -kernel inet_backend socket
</code></pre></div></div>
<p>or set it with</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERL_FLAGS="-kernel inet_backend socket"
</code></pre></div></div>
      <h1 id="help-in-the-shell">
        
        
          Help in the shell <a href="#help-in-the-shell">#</a>
        
        
      </h1>
    
<p>We have implemented <a href="http://erlang.org/eeps/eep-0048.html">EEP 48</a> which specifies a storage format for API documentation to be used by BEAM languages. By standardizing how API documentation is stored, it will be possible to write tools that work across languages.</p>

<p>The ordinary doc build is extended with the generation of <code class="language-plaintext highlighter-rouge">.chunk</code> files for all OTP modules. You can run <code class="language-plaintext highlighter-rouge">make docs DOC_TARGETS=chunks</code> to build only the EEP 48 chunks. Running just <code class="language-plaintext highlighter-rouge">make docs</code> without setting the DOC_TARGETS variable will build all formats (html, man, pdf, chunks).</p>

<p>Built on these new features we’ve added On-line help in the shell with the functions:</p>
<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">h</span><span class="p">(</span><span class="nv">Module</span><span class="p">)</span> 
<span class="nf">h</span><span class="p">(</span><span class="nv">Module</span><span class="p">,</span><span class="nv">Function</span><span class="p">),</span> 
<span class="nf">h</span><span class="p">(</span><span class="nv">Module</span><span class="p">,</span><span class="nv">Function</span><span class="p">,</span><span class="nv">Arity</span><span class="p">)</span>
</code></pre></div></div>
<p>There are also corresponding functions <code class="language-plaintext highlighter-rouge">ht/1,2,3</code> and <code class="language-plaintext highlighter-rouge">hcb/1,2,3</code> to get help about types and callback functions</p>

<p>We have added a new module <code class="language-plaintext highlighter-rouge">shell_docs</code> in <code class="language-plaintext highlighter-rouge">stdlib</code> with functions for rendering documentation for a shell. This can be used for instance by Development Environments such as those based on the Language Server Protocol (LSP).</p>

<p>The <code class="language-plaintext highlighter-rouge">code</code> module also got a new function, <code class="language-plaintext highlighter-rouge">get_doc</code> which returns the doc chunk without loading the module.</p>

<p>See example below for getting documentation for <code class="language-plaintext highlighter-rouge">lists:sort/2</code></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4&gt; h(lists,sort,2).

  -spec sort(Fun, List1) -&gt; List2
                when
                    Fun :: fun((A :: T, B :: T) -&gt; boolean()),
                    List1 :: [T],
                    List2 :: [T],
                    T :: term().

  Returns a list containing the sorted elements of List1,
  according to the ordering function Fun. Fun(A, B) is to
  return true if A compares less than or equal to B in the
  ordering, otherwise false.
ok
</code></pre></div></div>
      <h2 id="improved-tab-completion">
        
        
          Improved tab-completion <a href="#improved-tab-completion">#</a>
        
        
      </h2>
    
<p>The tab-completion in the shell is also improved. Previously the tab-completion for modules did only work for already loaded modules now this is extended to work for all modules available in the code path. The completion is also extended to work inside the “help” functions h, ht and hcb. You can for example press tab like the example below and get all modules beginning with <code class="language-plaintext highlighter-rouge">l</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5&gt; h(l
lcnt                      leex                      lists                     
local_tcp                 local_udp                 log_mf_h                  
logger                    logger_backend            logger_config             
logger_disk_log_h         logger_filters            logger_formatter          
logger_h_common           logger_handler_watcher    logger_olp                
logger_proxy              logger_server             logger_simple_h           
logger_std_h              
logger_sup
</code></pre></div></div>
<p>Or complete all functions beginning with <code class="language-plaintext highlighter-rouge">s</code> in the <code class="language-plaintext highlighter-rouge">lists</code> module like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5&gt; h(lists,s
search/2     seq/2        seq/3        sort/1       sort/2       split/2      
splitwith/2  sublist/2    sublist/3    subtract/2   suffix/2     sum/1        
</code></pre></div></div>
      <h1 id="container-friendly-features">
        
        
          “Container friendly” features <a href="#container-friendly-features">#</a>
        
        
      </h1>
    
      <h2 id="take-cpu-quotas-into-account">
        
        
          Take CPU quotas into account <a href="#take-cpu-quotas-into-account">#</a>
        
        
      </h2>
    
<p>CPU quotas are now taken into account when deciding the default number of online schedulers.</p>

<p>Thus, automatically making Erlang a good citizen in container environments where quotas are applied, such as docker with the <code class="language-plaintext highlighter-rouge">--cpus</code> flag.</p>
      <h2 id="epmd-independence">
        
        
          EPMD independence <a href="#epmd-independence">#</a>
        
        
      </h2>
    

<p>In a cloud and container based environment it might be interesting to run distributed Erlang nodes without use of <code class="language-plaintext highlighter-rouge">epmd</code> and use a hard coded port or an alternative service discovery. Because of this we introduce ways to make it easier to start and configure systems without <code class="language-plaintext highlighter-rouge">epmd</code>.</p>
      <h3 id="handshake">
        
        
          Handshake <a href="#handshake">#</a>
        
        
      </h3>
    
<p>We have improved the handshake during connection setup in the Erlang distribution protocol.
It is now possible to agree on protocol version without depending on <code class="language-plaintext highlighter-rouge">epmd</code> or other prior knowledge of peer node version.</p>
      <h3 id="dynamic-node-name">
        
        
          Dynamic node name <a href="#dynamic-node-name">#</a>
        
        
      </h3>
    

<p>Another feature introduced together with the new handshake is the dynamic node name. A dynamic node name is chosen by using the options <code class="language-plaintext highlighter-rouge">-name Name</code> or <code class="language-plaintext highlighter-rouge">-sname Name</code> and setting <code class="language-plaintext highlighter-rouge">Name</code> to <code class="language-plaintext highlighter-rouge">undefined</code>.</p>

<p>These options
makes the Erlang runtime system into a distributed node. These flags invokes all network servers necessary for a node to become distributed; see <code class="language-plaintext highlighter-rouge">net_kernel</code>. It is also ensured that <code class="language-plaintext highlighter-rouge">epmd</code> runs on the current host before Erlang is started; see epmd and the <code class="language-plaintext highlighter-rouge">-start_epmd</code> option.</p>

<p><strong>The new feature in OTP 23</strong> is that 
<code class="language-plaintext highlighter-rouge">Name</code> can be set to <code class="language-plaintext highlighter-rouge">undefined</code> and then the node will be started in a special mode optimized to be the <strong>temporary client</strong> of another node. When enabled the node will request a dynamic node name from the first node it connects to. In addition these distribution settings will be implied:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>erl -dist_listen false -hidden -dist_auto_connect never
</code></pre></div></div>
<p>Because <code class="language-plaintext highlighter-rouge">-dist_auto_connect</code> is set to <code class="language-plaintext highlighter-rouge">never</code>, the system will have to manually call <code class="language-plaintext highlighter-rouge">net_kernel:connect_node/1</code> in order to start the distribution. If the distribution channel is closed, when a node uses a dynamic node name, the node will stop the distribution and a new call to <code class="language-plaintext highlighter-rouge">net_kernel:connect_node/1</code> has to be made. Note that the node name may change if the distribution is dropped and then set up again.</p>

<p><strong>Note!</strong>
The dynamic node name feature is supported from OTP 23. Both the temporary client node and the first connected peer node (supplying the dynamic node name) must be at least OTP 23 for it to work.</p>
      <h3 id="new-options-to-control-the-use-of-epmd">
        
        
          New options to control the use of <code class="language-plaintext highlighter-rouge">epmd</code> <a href="#new-options-to-control-the-use-of-epmd">#</a>
        
        
      </h3>
    

<p>To give the user more control over the use of <code class="language-plaintext highlighter-rouge">epmd</code> some new options to the inet distribution has been added.</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-dist_listen false</code> Setup the distribution channel, but do not listen for incoming connection. This is useful when you want to use the current node to interact with another node on the same machine without it joining the entire cluster.</p>
  </li>
  <li><code class="language-plaintext highlighter-rouge">-erl_epmd_port Port</code> Configure a default port that the built-in EPMD client should return. This allows the local node to know the port to connect to for any other node in the cluster.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">-remsh Node</code> Starts Erlang with a remote shell connected to <code class="language-plaintext highlighter-rouge">Node</code>.
  If no <code class="language-plaintext highlighter-rouge">-name</code> or <code class="language-plaintext highlighter-rouge">-sname</code> is given the node will be started using <code class="language-plaintext highlighter-rouge">-sname undefined</code>. 
  If Node is using long names then you should give <code class="language-plaintext highlighter-rouge">-name undefined</code>.
  If <code class="language-plaintext highlighter-rouge">Node</code> does not contain a hostname, one is automatically taken from the <code class="language-plaintext highlighter-rouge">-name</code> or <code class="language-plaintext highlighter-rouge">-sname</code> option.</p>

    <p><strong>Note</strong>
  Before OTP-23 the user needed to supply a valid <code class="language-plaintext highlighter-rouge">-sname</code> or <code class="language-plaintext highlighter-rouge">-name</code> for <code class="language-plaintext highlighter-rouge">-remsh</code> to work. 
  This is still the case if the target node is not running OTP-23 or later.</p>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># starting the E-node test</span>
erl <span class="nt">-sname</span> <span class="nb">test</span>@localhost 

<span class="c"># starting a temporary E-node (with dynamic name) as a remote shell to</span>
<span class="c"># the node test</span>
erl <span class="nt">-remsh</span> <span class="nb">test</span>@localhost 
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">erl_epmd</code> callback API has also been extended to allow returning -1 as the creation which means that a random creation will be created by the node.</p>

<p>In addition a new callback function called
<code class="language-plaintext highlighter-rouge">listen_port_please</code> has been added that allows the callback to return which listen port the distribution should use. This can be used instead of <code class="language-plaintext highlighter-rouge">inet_dist_listen_min/max</code> if the listen port is to be fetched from an external service.</p>
      <h2 id="new-option-for-erl_call">
        
        
          New option for <code class="language-plaintext highlighter-rouge">erl_call</code> <a href="#new-option-for-erl_call">#</a>
        
        
      </h2>
    

<p><code class="language-plaintext highlighter-rouge">erl_call</code> is a C program originally bundled as an example inside the <code class="language-plaintext highlighter-rouge">erl_interface</code> application.
<code class="language-plaintext highlighter-rouge">erl_interface</code> contains C-libraries for communicating with Erlang nodes and letting C programs behave as if they are Erlang nodes. They are then called C nodes. <code class="language-plaintext highlighter-rouge">erl_call</code> has become popular and is used in products mainly for administration of an Erlang node on the same host. In OTP 23 <code class="language-plaintext highlighter-rouge">erl_call</code> is installed under the same path as <code class="language-plaintext highlighter-rouge">erl</code> making available in the path without bothering about the <code class="language-plaintext highlighter-rouge">erl_interface</code> version. 
Another new thing in <code class="language-plaintext highlighter-rouge">erl_call</code> is the <code class="language-plaintext highlighter-rouge">address</code> option, that can be used to connect directly to a node  without being dependent on <code class="language-plaintext highlighter-rouge">epmd</code> to resolve the node name.</p>

<p>AFAIK <code class="language-plaintext highlighter-rouge">erl_call</code> is being used in the upcoming version of relx (used by rebar3) for the node_tool function.</p>
      <h1 id="tls-enhancements-and-changes">
        
        
          TLS enhancements and changes <a href="#tls-enhancements-and-changes">#</a>
        
        
      </h1>
    
<p>TLS-1.3 is now supported (in OTP 22 we classed it as experimental) but not yet feature complete. 
Key features supported are:</p>
<ul>
  <li>session tickets</li>
  <li>refreshing of session keys</li>
  <li>RSASSA-PSS signatures</li>
  <li>Middlebox compatibility.</li>
</ul>

<p>The “early data” feature is not yet supported. Early data is an optimization introduced in TLS 1.3 which allows a client to send data to a server in the first round trip of a connection, without waiting for the TLS handshake to complete if the client has spoken to the same server recently.</p>

<p>In OTP 23 TLS 1.3 is per default announced as the preferred protocol version by both client and server. Users who are not explicitly configuring the TLS versions should be aware of this since it can have impact on interoperability.</p>

<p>A new option <code class="language-plaintext highlighter-rouge">exclusive</code> is provided for <code class="language-plaintext highlighter-rouge">ssl:cipher_suites/2,3</code> and <code class="language-plaintext highlighter-rouge">ssl:versions</code> is extended to better reflect what versions of TLS that are available for the current  setup of Erlang/OTP.</p>

<p>Also note that we have removed support for the legacy TLS version SSL-3.0.</p>
      <h1 id="ssh">
        
        
          SSH <a href="#ssh">#</a>
        
        
      </h1>
    
<p>Two notable SSH features were provided as Pull Requests from open source users, namely support for fetching keys from ssh-agents and TCP/IP port forwarding.  Port forwarding is sometimes called tunneling or tcp-forward/direct-tcp. In the OpenSSH client, port forwarding corresponds to the options -L and -R.</p>

<p>Ssh agent stored keys improves the security while port forwarding is often used to get an encrypted tunnel between two hosts. In the area of key handling, the default key plugin <code class="language-plaintext highlighter-rouge">ssh_file.erl</code> is rewritten and extended with OpenSSH file format “openssh-key-v1”.  A limitation so far is that keys in the new format cannot be encrypted The default plugin now also uses port numbers which increases the security.</p>

<p>The SSH application can now be configured in an Erlang config-file. This gives the possibility to for example change the supported algorithm set without code change.</p>
      <h1 id="crypto">
        
        
          Crypto <a href="#crypto">#</a>
        
        
      </h1>
    
<p>A new crypto API was introduced in OTP-22.0.  The main reason for a new API was to use the OpenSSL libcrypto EVP API that enables HW acceleration, if the machine supports it.  The naming of crypto algorithms is also systemized and now follows the schema in OpenSSL.</p>

<p>There are parts of the Crypto app that are using very old APIs while other parts are using the latest one.
It turned out that using the old API in the new way, and still keeping it backwards compatible, was not possible.</p>

<p>Therefore the old API is kept for now but it is implemented with new primitives.
The Old API is deprecated in OTP-23.0 and will be removed in OTP-24.0.</p>

        
    </div>
</article>
        </div>
    </div>
</div>
<script src="/erlang-org/assets/js/prismjs/prism.js"></script>
<script src="/erlang-org/assets/js/prismjs/components/prism-erlang.js"></script>
<script src="/erlang-org/assets/js/prismjs/components/prism-c.js"></script>
<script src="/erlang-org/assets/js/prismjs/components/prism-bash.js"></script>
    <footer class="container-fluid footer text-center border-top border-bottom">
        <div>
            <a href="/erlang-org/downloads.html" title="DOWNLOAD"><img src="/erlang-org/assets/img/download.png"></a>
        </div>
        <div>
            <a href="http://www.github.com/erlang/otp"><img
                    src="/erlang-org/assets/img/GitHub-Mark-32px.png"></a>
        </div>
        
        <div>
            <a href="http://www.twitter.com/erlang_org"><img src="/erlang-org/assets/img/twitter.png"
                    width="32"></a>
        </div>
    </footer>
    <script src="/erlang-org/assets/js/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>