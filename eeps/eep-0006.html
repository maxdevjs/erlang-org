<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Allow pinning of website on windows -->
    <meta name="application-name" content="Erlang.org">
    <meta name="msapplication-tooltip" content="The official home of the Erlang Programming Language">
    <meta name="msapplication-starturl" content="/erlang-org/" >

    <!-- Make the site look nicer on facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Erlang.org">
    <meta property="og:title" content="Welcome to Erlang.org">
    <meta property="og:description" content="The official home of the Erlang Programming Language">
    <meta property="og:image" content="https://erlang.github.io/erlang-org/assets/img/erlang-228x200.png">
    <meta property="og:image:secure_url" content="https://erlang.github.io/erlang-org/assets/img/erlang-228x200.png">
    <meta property="og:url" content="https://erlang.github.io/erlang-org/">

    <!-- Twitter metadata -->
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Index" />
    <meta name="twitter:site" content="@erlang_org" />

    <!-- Rich data for google search -->
    <script type="application/ld+json">
{"@type":"WebSite","url":"https://erlang.org/","headline":"Eep 0006 - Erlang/OTP","name":"Erlang.org","sameAs":["https://twitter.com/erlang_org","https://github.com/erlang/otp"],"@context":"https://schema.org"}</script>

    <title>Eep 0006 - Erlang/OTP</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- tells iOS browsers to not show telephone numbers as links -->
    <meta name="format-detection" content="telephone=no">

    <meta name="application-name" content="Erlang.org">
    <meta name="description" content="The official home of the Erlang Programming Language">
    <meta name="keywords" content="Erlang programming language functional parallel distributed documentation download community">
    <!-- https://www.rssboard.org/rss-autodiscovery -->
    <link rel="alternate" type="application/atom+xml" title="News Atom Feed" href="https://erlang.github.io/erlang-org/news.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Atom Feed" href="https://erlang.github.io/erlang-org/blog.xml" />
    
    <link rel="stylesheet" href="/erlang-org/assets/css/main.css">
</head>

<body>
    <header class="navbar navbar-expand-lg navbar-light bg-body">
        <nav class="container">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/erlang-org/"><img
                    src="/erlang-org/assets/img/erlang.png" class="img-fluid" width="60" alt="Erlang.org main page"/></a>
            <div class="collapse navbar-collapse fw-bold" id="navbarSupportedContent">
                <ul class="navbar-nav text-uppercase me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/downloads">Download</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/docs">Documentation</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/community">Community</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/blog">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/eep">EEP</a></li>
                    <li class="nav-item"><a class="nav-link" href="/erlang-org/about">About</a></li>
                </ul>
                <form class="d-flex" role="search" method="post" action="https://duckduckgo.com/?kg=p"
                    onsubmit="document.getElementById('searchq').value = document.getElementById('searchfield').value + ' site:erlang.org'; return true;">
                    <input type="hidden" id="searchq" name="q" class="hidden" />
                    <input class="form-control me-2" id="searchfield" type="search" placeholder="Search erlang.org"
                        aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
            </div>
        </nav>
    </header>
    <div class="container border-top pt-4">
    <div class="row-lg">
        <div class="col-lg-10 offset-lg-1">
            <div class="card">
                <div class="card-body">
                    <dl class="mb-0 dl-single">
                        <dt>Author:</dt>
                        <dd>
                            Björn Gustavsson &lt;bjorn(at)erlang(dot)org&gt;
                            
                            
                        </dd>
                        
                        <dt>Status:</dt>
                        <dd>Final/R12B-0 Proposal is implemented in OTP release R12B-0</dd>
                        <dt>Type:</dt>
                        <dd>Standards Track</dd>
                        
                        
                        <dt>Created:</dt>
                        <dd>10-Aug-2007</dd>
                        
                        <dt>Erlang-Version:</dt>
                        <dd>R12B-0</dd>
                        
                        
                        
                        
                    </dl>
                </div>
            </div>
            <div class="border-top mt-4">
                <h2 id="eep-6-new-bifs-for-tuple-and-binary-sizes">EEP 6: New BIFs for tuple and binary sizes</h2>

<h1 id="abstract">Abstract</h1>

<p>This EEP describes the two new guards BIFs <code class="language-plaintext highlighter-rouge">tuple_size/1</code>  and <code class="language-plaintext highlighter-rouge">byte_size/1 </code>
as a prefered alternative to the  <code class="language-plaintext highlighter-rouge">size/1 </code> BIF.</p>

<h1 id="specifications">Specifications</h1>

<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">byte_size</span><span class="o">/</span><span class="mi">1</span><span class="p">::</span><span class="nf">bitstring</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nf">integer</span><span class="p">()</span>
</code></pre></div></div>

<p>Returns the number of bytes needed to store the entire <em>bitstring</em>
(see <a href="eep-0004.md" title="EEP 4">EEP 4</a>). This BIF will return the same value as
<code class="language-plaintext highlighter-rouge">(bit_size(Bin)+7) div 8</code> (that is, the number of bytes will be
rounded up if number of bits is not evenly divisible by 8).
This BIF is allowed in guards.</p>

<div class="language-erlang highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tuple_size</span><span class="o">/</span><span class="mi">1</span><span class="p">::</span><span class="nf">tuple</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nf">integer</span><span class="p">()</span>
</code></pre></div></div>

<p>Returns the size of a tuple. This BIF will fail if passed anything
that is not a tuple. This BIF is allowed in guards.</p>

<h1 id="rationale">Rationale</h1>

<p>The <code class="language-plaintext highlighter-rouge">size/1</code> BIF accepts either a binary or a tuple, and returns
either the size of binary in bytes or the size of the tuple.</p>

<p>Because <code class="language-plaintext highlighter-rouge">size/1</code> accepts two different types, it is difficult to
optimize uses of it, both in the compiler and in the run-time system.
Adding the two new BIF will faciliate optimization, and will also
help Dialyzer.</p>

<p>It could be argued that <code class="language-plaintext highlighter-rouge">byte_size/1</code> should only work for
binaries (bitstrings whose size in bits is disivible by 8) to catch
the bug that the code cannot handle general bitstrings and still does not
use an <code class="language-plaintext highlighter-rouge">is_binary/1</code> guard test. In my opinion, if the programmer
must round up the result from <code class="language-plaintext highlighter-rouge">bit_size/1</code> to a whole number of bytes,
he or she is more likely to get <em>that</em> wrong: The “obvious” expressions
<code class="language-plaintext highlighter-rouge">bit_size(B) / 8 + 1</code> or <code class="language-plaintext highlighter-rouge">bit_size(B) div 8 + 1</code> are both wrong,
and the correct expression <code class="language-plaintext highlighter-rouge">(bit_size(B)+7) div 8</code> is not immediately
obvious.</p>

<h1 id="implementation">Implementation</h1>

<p>The implementation is trivial.</p>

<h1 id="backwards-compatibility">Backwards Compatibility</h1>

<p>Code containing local functions named <code class="language-plaintext highlighter-rouge">tuple_size/1</code> or <code class="language-plaintext highlighter-rouge">byte_size/1</code>
need to be changed.</p>

<p>The compiler will issue a warning that <code class="language-plaintext highlighter-rouge">size/1</code> is deprecated
and will be removed in R14B for code that uses <code class="language-plaintext highlighter-rouge">size/1</code>.</p>


            </div>
        </div>
    </div>
</div>
<script src="/erlang-org/assets/js/prismjs/prism.js"></script>
<script src="/erlang-org/assets/js/prismjs/components/prism-erlang.js"></script>
    <footer class="container-fluid footer text-center border-top border-bottom">
        <div>
            <a href="/erlang-org/downloads.html" title="DOWNLOAD"><img src="/erlang-org/assets/img/download.png"></a>
        </div>
        <div>
            <a href="http://www.github.com/erlang/otp"><img
                    src="/erlang-org/assets/img/GitHub-Mark-32px.png"></a>
        </div>
        
        <div>
            <a href="http://www.twitter.com/erlang_org"><img src="/erlang-org/assets/img/twitter.png"
                    width="32"></a>
        </div>
    </footer>
    <script src="/erlang-org/assets/js/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>